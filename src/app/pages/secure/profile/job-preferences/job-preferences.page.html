<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/secure/tabs/profile"></ion-back-button>
    </ion-buttons>

    <ion-title>Job Preferences</ion-title>

    <ion-buttons slot="end">
      <ion-button (click)="openEdit()" aria-label="Edit job preferences">
        <ion-icon name="create-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="job-prefs ion-padding">
  @if (jobPreferences(); as jobPreferences) {
  <section class="summary-card">
    <div class="icon-badge">
      <ion-icon name="briefcase-outline" aria-hidden="true"></ion-icon>
    </div>

    <div class="summary">
      <div class="name">Your job preferences</div>

      <div class="meta">
        <ion-icon name="location-outline" aria-hidden="true"></ion-icon>
        <span>{{ jobPreferences.locationName }}</span>
      </div>

      <div class="badge-row">
        <span class="pill"
          >Radius: {{ jobPreferences.locationRadiusMeters }} miles</span
        >
        <span class="pill">Pay: £{{ jobPreferences.expectedPay }}/h</span>
      </div>
    </div>
  </section>
  <section class="section-card">
    <div class="section-header">
      <h2>Location &amp; Pay</h2>
      <ion-icon name="navigate-outline" aria-hidden="true"></ion-icon>
    </div>

    <div class="kv">
      <div class="kv-row">
        <div class="kv-label">Location</div>
        <div class="kv-value">{{ jobPreferences.locationName }}</div>
      </div>
      <div class="kv-row">
        <div class="kv-label">Distance radius</div>
        <div class="kv-value">
          {{ jobPreferences.locationRadiusMeters }} miles
        </div>
      </div>
      <div class="kv-row">
        <div class="kv-label">Pay expectation</div>
        <div class="kv-value">£{{ jobPreferences.expectedPay }}/h</div>
      </div>
    </div>
  </section>
  <section class="section-card">
    <div class="section-header">
      <h2>Trade</h2>
      <ion-icon name="build-outline" aria-hidden="true"></ion-icon>
    </div>

    <div class="kv">
      <div class="kv-row">
        <div class="kv-label">Trade category</div>
        <div class="kv-value">{{ jobPreferences.tradeCategory }}</div>
      </div>
      <div class="kv-row">
        <div class="kv-label">Trade sub-category</div>
        <div class="kv-value">{{ jobPreferences.tradeSubcategory }}</div>
      </div>
    </div>
  </section>

  <div class="bottom-spacer" aria-hidden="true"></div>
  }
</ion-content>

<ion-modal [isOpen]="isEditOpen()" (didDismiss)="closeEdit()">
  <ng-template>
    <app-profile-edit
      [title]="'Edit job preferences'"
      [isPersonalDetails]="false"
      [value]="jobPreferences()"
      [selectOptions]="{
        tradeCategory: tradeCategories(),
        tradeSubcategory: tradeSubcategories()
      }"
      (cancel)="closeEdit()"
      (save)="handleSave($event)"
    />
  </ng-template>
</ion-modal>
