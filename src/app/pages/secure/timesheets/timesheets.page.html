<ion-content [fullscreen]="true" class="ion-no-margin">
  <div class="home-hero-shell">
    <app-toolbar-home
      [firstName]="firstName()"
      [notificationsCount]="unreadCount()"
    ></app-toolbar-home>

    <ion-refresher slot="fixed" (ionRefresh)="onRefresh($event)">
      <ion-refresher-content
        pullingText="Pull to refresh"
      ></ion-refresher-content>
    </ion-refresher>

    @if (loading()) {
    <div class="hero-card-wrap">
      <ion-card class="hero-card ion-no-margin ion-text-center">
        <div class="hero-card-header ion-padding">
          <p class="hero-eyebrow">
            <ion-skeleton-text
              animated
              style="width: 90px; height: 14px"
            ></ion-skeleton-text>
          </p>

          <h2 class="hero-heading ion-no-margin">
            <ion-skeleton-text
              animated
              style="width: 65%; height: 26px"
            ></ion-skeleton-text>
          </h2>

          <div class="current-job-company ion-padding-top">
            <ion-skeleton-text
              animated
              style="width: 50%; height: 16px"
            ></ion-skeleton-text>
          </div>

          <ion-button
            class="ion-padding-top current-job-button"
            expand="block"
            disabled
          >
            <ion-skeleton-text
              animated
              style="width: 60%; height: 16px"
            ></ion-skeleton-text>
          </ion-button>
        </div>
      </ion-card>
    </div>
    <div class="home-body">
      <h2 class="section-title ion-padding-vertical">
        <ion-skeleton-text
          animated
          style="width: 120px; height: 20px"
        ></ion-skeleton-text>
      </h2>

      <ion-list inset="true" class="past-jobs-list">
        @for (i of [1,2,3,4]; track i) {
        <ion-item class="past-job-item">
          <div class="past-job-inner">
            <ion-label class="past-job-label">
              <div class="past-job-header">
                <h3 class="past-job-title">
                  <ion-skeleton-text
                    animated
                    style="width: 70%; height: 16px"
                  ></ion-skeleton-text>
                </h3>
              </div>

              <div class="past-job-row">
                <ion-skeleton-text
                  animated
                  style="width: 55%; height: 14px"
                ></ion-skeleton-text>
              </div>

              <div class="past-job-row">
                <ion-skeleton-text
                  animated
                  style="width: 45%; height: 14px"
                ></ion-skeleton-text>
              </div>
            </ion-label>

            <ion-icon
              class="past-job-chevron"
              name="chevron-forward-outline"
              aria-hidden="true"
            ></ion-icon>
          </div>
        </ion-item>
        }
      </ion-list>
    </div>
    } @else { @if (hasCurrent()) {
    <div class="hero-card-wrap">
      <ion-card class="hero-card ion-no-margin ion-text-center">
        <div class="hero-card-header ion-padding">
          <p class="hero-eyebrow">Current Job</p>

          <h2 class="hero-heading ion-no-margin">{{ current()!.role }}</h2>

          <div class="current-job-company ion-padding-top">
            <ion-icon name="pricetag-outline"></ion-icon>
            {{ current()!.clientName }}
          </div>

          <ion-button
            class="ion-padding-top current-job-button"
            expand="block"
            color="primary"
            (click)="openCurrentTimesheet(current())"
          >
            Check In
          </ion-button>
        </div>
      </ion-card>
    </div>
    } @else {
    <div class="hero-card-wrap">
      <ion-card class="hero-card ion-no-margin ion-text-center empty-job-card">
        <div class="hero-card-header ion-padding empty-job-header">
          <p class="empty-job-pill">No current job</p>

          <p class="empty-job-copy">
            Browse open roles, pick shifts that suit you, and your next job will
            appear here for quick check-in.
          </p>

          <ion-button
            class="ion-padding-top current-job-button"
            expand="block"
            color="primary"
            (click)="goToJobsList()"
          >
            Browse jobs
          </ion-button>
        </div>
      </ion-card>
    </div>
    }

    <div class="home-body">
      <h2 class="section-title ion-padding-vertical">Past jobs</h2>

      @if (hasHistory()) {
      <ion-list inset="true" class="past-jobs-list">
        @for (a of history(); track a.jobListingId) {
        <ion-item
          class="past-job-item"
          button
          detail="false"
          (click)="openHistoricalTimesheet(a)"
        >
          <div class="past-job-inner">
            <ion-label class="past-job-label">
              <div class="past-job-header">
                <h3 class="past-job-title">{{ a.role }}</h3>
              </div>

              <div class="past-job-row">
                <ion-icon
                  name="pricetag-outline"
                  class="past-job-row-icon"
                  aria-hidden="true"
                ></ion-icon>
                <span>{{ a.clientName }}</span>
              </div>

              <div class="past-job-row">
                <ion-icon
                  name="calendar-clear-outline"
                  class="past-job-row-icon"
                  aria-hidden="true"
                ></ion-icon>
                <span>{{ dates(a) }}</span>
              </div>
            </ion-label>

            <ion-icon
              class="past-job-chevron"
              name="chevron-forward-outline"
              aria-hidden="true"
            ></ion-icon>
          </div>
        </ion-item>
        }
      </ion-list>
      } @else {
      <div class="empty">No past jobs.</div>
      }
    </div>
    }
  </div>
</ion-content>
