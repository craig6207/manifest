<ion-content [fullscreen]="true" class="register-page">
  <div class="page-inner">
    <section class="hero">
      <div class="hero-top">
        <ion-button
          fill="clear"
          size="small"
          class="back-btn"
          (click)="goBack()"
          aria-label="Back to login"
        >
          <ion-icon name="chevron-back-outline" slot="icon-only"></ion-icon>
        </ion-button>
      </div>

      <img
        class="hero-logo"
        src="/assets/img/Recruut_logo.svg"
        width="200"
        height="200"
        alt="WeRecruit logo"
      />

      <h1 class="hero-title">Create account</h1>
    </section>
    <section class="form-card">
      <form
        [formGroup]="signup_form"
        (ngSubmit)="signUp()"
        novalidate
        class="form-default"
      >
        <ion-list lines="none" class="form-list">
          <ion-item class="input-item">
            <ion-icon name="mail-outline" slot="start"></ion-icon>
            <ion-input
              #emailInput
              formControlName="email"
              type="email"
              placeholder="Email"
              autocapitalize="off"
              autocomplete="email"
              inputmode="email"
            >
            </ion-input>
          </ion-item>

          @if (signup_form.get('email')!.invalid &&
          (signup_form.get('email')!.touched || submit_attempt)) { @if
          (signup_form.get('email')!.errors?.['required']) {
          <div class="error">Email is required.</div>
          } @if (signup_form.get('email')!.errors?.['email']) {
          <div class="error">Please enter a valid email.</div>
          } }
          <ion-item class="input-item">
            <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
            <ion-input
              formControlName="password"
              type="password"
              placeholder="Password"
              autocomplete="new-password"
            >
              <ion-input-password-toggle slot="end"></ion-input-password-toggle>
            </ion-input>
          </ion-item>

          @if (signup_form.get('password')!.invalid &&
          (signup_form.get('password')!.touched || submit_attempt)) { @if
          (signup_form.get('password')!.errors?.['strongPassword']) {
          <div class="error">
            Password must be at least 9 characters and include upper, lower, and
            a number.
          </div>
          } }

          <ion-item class="input-item">
            <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
            <ion-input
              formControlName="passwordRepeat"
              type="password"
              placeholder="Repeat password"
              autocomplete="new-password"
            >
              <ion-input-password-toggle slot="end"></ion-input-password-toggle>
            </ion-input>
          </ion-item>

          @if (signup_form.get('passwordRepeat')!.invalid &&
          (signup_form.get('passwordRepeat')!.touched || submit_attempt)) { @if
          (signup_form.get('passwordRepeat')!.errors?.['required']) {
          <div class="error">Please repeat your password.</div>
          } }
          <ion-item class="input-item">
            <ion-select
              formControlName="countryIso2"
              interface="popover"
              aria-label="Select country calling code"
              placeholder="Country"
            >
              @for (c of countries; track c.iso2) {
              <ion-select-option [value]="c.iso2">
                {{ c.name }} ({{ c.dialCode }})
              </ion-select-option>
              }
            </ion-select>
          </ion-item>

          <ion-item class="input-item">
            <ion-icon name="call-outline" slot="start"></ion-icon>
            <ion-input
              formControlName="phoneLocal"
              type="tel"
              inputmode="tel"
              placeholder="Mobile number"
            >
            </ion-input>
          </ion-item>

          @if (signup_form.get('phoneLocal')!.invalid &&
          (signup_form.get('phoneLocal')!.touched || submit_attempt)) {
          <div class="error">Please enter digits only (6-15).</div>
          }
        </ion-list>
        <ion-button
          id="open-loading"
          type="submit"
          [disabled]="signup_form.invalid"
          expand="block"
          class="primary-btn"
        >
          Sign Up
        </ion-button>

        <ion-toast
          [isOpen]="toastOption.show"
          position="top"
          [color]="toastOption.color"
          [message]="toastOption.message"
          duration="4000"
          keyboardClose="true"
          (didDismiss)="setToast()"
        >
        </ion-toast>
      </form>
    </section>
  </div>
</ion-content>
