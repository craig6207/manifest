<ion-content [fullscreen]="true" class="register-page">
  <div class="page-inner">
    <section class="hero">
      <div class="hero-top ion-padding-top">
        <ion-button
          fill="clear"
          size="small"
          class="back-btn"
          (click)="goBack()"
          aria-label="Back to login"
        >
          <ion-icon name="chevron-back-outline" slot="icon-only"></ion-icon>
        </ion-button>
      </div>

      <ion-img
        class="hero-logo"
        src="/assets/img/Recruut_logo.svg"
        alt="WeRecruit logo"
      ></ion-img>
    </section>
    <img
      class="cityline cityline--crane-left"
      src="/assets/img/crane2.svg"
      alt=""
      aria-hidden="true"
      role="presentation"
    />
    <img
      class="cityline cityline--back"
      src="/assets/img/building2.svg"
      alt=""
      aria-hidden="true"
      role="presentation"
    />
    <img
      class="cityline cityline--crane"
      src="/assets/img/crane1.svg"
      alt=""
      aria-hidden="true"
      role="presentation"
    />
    <img
      class="cityline cityline--front"
      src="/assets/img/building1.svg"
      alt=""
      aria-hidden="true"
      role="presentation"
    />

    <section class="form-card">
      <h2 class="card-title">Sign Up</h2>
      <form
        [formGroup]="signup_form"
        (ngSubmit)="signUp()"
        novalidate
        class="form-default"
      >
        <ion-list lines="none" class="form-list">
          <ion-item class="input-item ion-margin-bottom">
            <ion-icon name="mail-outline" slot="start"></ion-icon>
            <ion-input
              formControlName="email"
              type="email"
              placeholder="Enter email"
              autocapitalize="off"
              autocomplete="email"
              inputmode="email"
            ></ion-input>
          </ion-item>

          @if (signup_form.get('email')!.invalid &&
          (signup_form.get('email')!.touched || submit_attempt)) { @if
          (signup_form.get('email')!.errors?.['required']) {
          <div class="error">Email is required.</div>
          } @if (signup_form.get('email')!.errors?.['email']) {
          <div class="error">Please enter a valid email.</div>
          } }

          <ion-item class="input-item ion-margin-bottom">
            <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
            <ion-input
              formControlName="password"
              [type]="showPassword ? 'text' : 'password'"
              placeholder="Enter password"
              autocomplete="new-password"
            >
            </ion-input>
            <ion-button
              slot="end"
              fill="clear"
              size="small"
              class="field-icon-btn"
              type="button"
              (click)="togglePasswordVisibility()"
              [attr.aria-label]="showPassword ? 'Hide password' : 'Show password'"
            >
              <ion-icon
                [name]="showPassword ? 'eye-off-outline' : 'eye-outline'"
                slot="icon-only"
              ></ion-icon>
            </ion-button>
          </ion-item>

          @if (signup_form.get('password')!.invalid &&
          (signup_form.get('password')!.touched || submit_attempt)) { @if
          (signup_form.get('password')!.errors?.['strongPassword']) {
          <div class="error">
            Password must be at least 9 characters and include upper, lower, and
            a number.
          </div>
          } }

          <ion-item class="input-item ion-margin-bottom">
            <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
            <ion-input
              formControlName="passwordRepeat"
              [type]="showRepeatPassword ? 'text' : 'password'"
              placeholder="Confirm password"
              autocomplete="new-password"
            >
            </ion-input>
            <ion-button
              slot="end"
              fill="clear"
              size="small"
              class="field-icon-btn"
              type="button"
              (click)="toggleRepeatPasswordVisibility()"
              [attr.aria-label]="showRepeatPassword ? 'Hide password' : 'Show password'"
            >
              <ion-icon
                [name]="showRepeatPassword ? 'eye-off-outline' : 'eye-outline'"
                slot="icon-only"
              ></ion-icon>
            </ion-button>
          </ion-item>

          @if (signup_form.get('passwordRepeat')!.invalid &&
          (signup_form.get('passwordRepeat')!.touched || submit_attempt)) { @if
          (signup_form.get('passwordRepeat')!.errors?.['required']) {
          <div class="error">Please repeat your password.</div>
          } }

          <ion-grid class="phone-grid">
            <ion-row class="ion-align-items-stretch">
              <ion-col
                class="ion-no-padding"
                size="4"
                sizeSm="5"
                sizeMd="4"
                sizeLg="4"
              >
                <ion-item
                  class="input-item input-item-country ion-margin-bottom"
                >
                  <ion-select
                    formControlName="countryIso2"
                    interface="action-sheet"
                    aria-label="Select country calling code"
                    placeholder="Country"
                    [selectedText]="selectedDialText"
                    (ionChange)="onCountryChange($event.detail.value)"
                  >
                    @for (c of countries; track c.iso2) {
                    <ion-select-option [value]="c.iso2">
                      {{ c.flag }}&nbsp;{{ c.dialCode }} â€” {{ c.name }}
                    </ion-select-option>
                    }
                  </ion-select>
                </ion-item>
              </ion-col>

              <ion-col
                class="ion-no-padding"
                size="8"
                sizeSm="7"
                sizeMd="8"
                sizeLg="8"
              >
                <ion-item class="input-item ion-margin-bottom">
                  <ion-input
                    formControlName="phoneLocal"
                    type="tel"
                    inputmode="tel"
                    placeholder="Enter phone number"
                  ></ion-input>
                </ion-item>
                @if (signup_form.get('phoneLocal')!.invalid &&
                (signup_form.get('phoneLocal')!.touched || submit_attempt)) {
                <div class="error">Please enter digits only (6-15).</div>
                }
              </ion-col>
            </ion-row>
          </ion-grid>
        </ion-list>

        <ion-button
          type="submit"
          [disabled]="signup_form.invalid"
          expand="block"
          color="primary"
        >
          Sign Up
        </ion-button>

        <ion-toast
          [isOpen]="toastOption.show"
          position="top"
          [color]="toastOption.color"
          [message]="toastOption.message"
          duration="4000"
          keyboardClose="true"
          (didDismiss)="setToast()"
        ></ion-toast>
      </form>
    </section>
  </div>
</ion-content>
