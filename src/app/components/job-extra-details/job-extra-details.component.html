<ion-header>
  <ion-toolbar color="primary">
    <ion-title>{{ title() }}</ion-title>
    <ion-buttons slot="end">
      <ion-button fill="clear" (click)="dismiss()">
        <ion-icon name="close-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  @if (loading()) {
  <div class="skeleton">
    <ion-skeleton-text
      animated
      style="width: 60%; height: 20px"
    ></ion-skeleton-text>
    <ion-skeleton-text
      animated
      style="width: 90%; height: 16px"
    ></ion-skeleton-text>
    <ion-skeleton-text
      animated
      style="width: 80%; height: 16px"
    ></ion-skeleton-text>
  </div>
  } @if (!loading() && error()) {
  <div class="error">{{ error() }}</div>
  } @if (!loading() && !error() && details()) {
  <section class="hero">
    <h2 class="role">Site details</h2>
    @if (addressLine()) {
    <div class="client">{{ addressLine() }}</div>
    }
  </section>

  <ion-list inset="true" class="info-list">
    @if (details()?.siteContact) {
    <ion-item lines="full">
      <ion-label>
        <div class="title">Main contact</div>
        <div class="value">
          {{ details()?.siteContact?.name }}
          @if (details()?.siteContact?.phone) {
          <ng-container> Â· {{ details()?.siteContact?.phone }}</ng-container>
          }
        </div>
        @if (details()?.siteContact?.email) {
        <ion-note>{{ details()?.siteContact?.email }}</ion-note>
        }
      </ion-label>
    </ion-item>
    } @if (hoursText()) {
    <ion-item lines="full">
      <ion-label>
        <div class="title">Working hours</div>
        <div class="value">{{ hoursText() }}</div>
      </ion-label>
    </ion-item>
    } @if (ppeChips().length) {
    <ion-item lines="none">
      <ion-label>
        <div class="title">PPE</div>
        <div class="chips">
          @for (p of ppeChips(); track p) {
          <span class="pill neutral">{{ p }}</span>
          }
        </div>
      </ion-label>
    </ion-item>
    }
  </ion-list>

  @if (details()?.siteAddress?.notes) {
  <section class="card">
    <h3>Site notes</h3>
    <p class="project">{{ details()?.siteAddress?.notes }}</p>
  </section>
  } }
</ion-content>

<ion-footer class="ion-padding">
  <div class="btns">
    <ion-button
      expand="block"
      color="success"
      [disabled]="actioning()"
      (click)="confirm()"
    >
      Confirm
    </ion-button>

    <ion-button
      expand="block"
      color="danger"
      fill="outline"
      [disabled]="actioning()"
      (click)="decline()"
    >
      Decline
    </ion-button>
  </div>
</ion-footer>
